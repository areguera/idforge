######################################################################
#
#   Validate image color reduction (indexing) and LSS16 image
#   production. This configuration file produces images that can be
#   used by applications like GRUB and Anaconda which are limited in
#   the number of colors they use.  (e.g., GRUB uses indexed images of
#   14 colors while Anaconda uses indexed images of 16 colors).
#
#   Expected directory structure:
#   ------------------------------------------------------------------
#   QaTests/idforge-render/qatest-20150211182206285536962/Final
#   |-- 640x300-indexed.png
#   |-- 640x300-indexed.png.log
#   |-- 640x300.lss
#   |-- 640x300.lss.log
#   |-- 640x300.lss.ppm
#   |-- 640x300.png
#   `-- splashtolss.sh
#
#   0 directories, 7 files
#   ------------------------------------------------------------------
#
#   The CentOS Artwork SIG <centos-devel@centos.org>
#
######################################################################

#======================================================================
# Crop image from a larger image and set comment on final image
#======================================================================
# This section creates the image that will be target of color
# reduction. Such image has no modifications in the original color
# information it has and is taken from a common artistic motif for
# visual consistency with other visual manifestations. Notice how it
# is possible to use idforge functions and variables in the
# png-base-command options' value.
[640x300.png]
render-from          = "${PWD}/QaTests/idforge-render/qatest-commons/Backgrounds/640x480.png"
render-logic         = "remove-first"
render-directory     = "${PWD}/QaTests/idforge-render/qatest-20150211182206285536962/Final"
png-flow             = "base"
png-base-command     = "$(idforge_setParentDir ${RENDER_FILE});"
png-base-command     = "/usr/bin/convert -extract 640x300+0+0 +repage ${RENDER_FROM_FILE} ${RENDER_FILE};"
png-base-command     = "/usr/bin/mogrify -comment 'Created by '${IDFORGE}'-'${IDFORGE_VERSION} ${RENDER_FILE};"

# Another way of commenting an image is once it has been already
# produced. For such cases, you create a new section to control the
# action and set the png-base-comment option with the message as
# value.  This time the value of render-from must point to the image
# you want to set the comment in.
# [640x480-commented.png]
# render-from       = "${PWD}/QaTests/idforge-render/qatest-20150211182206285536962/Final/640x480.png"
# png-flow          = "base"
# png-base-comment  = "Created by ${IDFORGE}-${IDFORGE_VERSION}"

#======================================================================
# Create PNG with reduced number of colors
#======================================================================
# This section uses the cropped image as input and reduces its colors
# bases on a palette previously created with GIMP to produce an
# indexed PNG file. The color information set in the palette file is
# conceived by indexing the original image to the desired number of
# colors and then importing a new palette using the GIMP's palettes
# dialog. Once the palette was imported to GIMP, the color information
# in hexadecimal format is set in the comment field for each color in
# the palette, using GIMP's palette editor dialog. This step is
# necessary because idforge uses that information as reference to
# determine the number of colors and the color information as well
# that will be used in the reduction.  Finally, the palette file was
# copied to the location where this configuration file calls it. All
# this process of creating the palette file is necessary just one, or
# whenever you change the color information of the input image.
[640x300-indexed.png]
render-from          = "${PWD}/QaTests/idforge-render/qatest-20150211182206285536962/Final/640x300.png"
render-directory     = "${PWD}/QaTests/idforge-render/qatest-20150211182206285536962/Final/"
png-flow             = "indexed"
png-indexed-gpl      = "${PWD}/QaTests/idforge-render/qatest-commons/Backgrounds/640x480.png-16colors.gpl"

#======================================================================
# Create LSS16 image from full color PNG image
#======================================================================
# The name of this section must end in .lss in order to tell idforge
# to produce a LSS16 image. In any other case, the file extension you
# provide in the section name is irrelevant. Beyond this
# specification, this section does pretty much the same thing of the
# previous one, except it calls the lss module to perform the
# ppmtolss16 conversion.
[640x300.lss]
render-from          = "${PWD}/QaTests/idforge-render/qatest-20150211182206285536962/Final/640x300.png"
render-directory     = "${PWD}/QaTests/idforge-render/qatest-20150211182206285536962/Final/"
png-flow             = "indexed"
png-indexed-gpl      = "${PWD}/QaTests/idforge-render/qatest-commons/Backgrounds/640x480.png-16colors.gpl"
